<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Plot of Metric MDS object — ggplotSampleMDS • CytoMDS</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plot of Metric MDS object — ggplotSampleMDS"><meta name="description" content="ggplotSampleMDS uses ggplot2
to provide plots of Metric MDS results.
By default, a pseudo Rsquare projection quality indicator,
and the number of dimensions of the MDS projection are provided in sub-title"><meta property="og:description" content="ggplotSampleMDS uses ggplot2
to provide plots of Metric MDS results.
By default, a pseudo Rsquare projection quality indicator,
and the number of dimensions of the MDS projection are provided in sub-title"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">CytoMDS</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3.6</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/CytoMDS.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/UCLouvain-CBIO/CytoMDS/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Plot of Metric MDS object</h1>
      <small class="dont-index">Source: <a href="https://github.com/UCLouvain-CBIO/CytoMDS/blob/main/R/ggplots.R" class="external-link"><code>R/ggplots.R</code></a></small>
      <div class="d-none name"><code>ggplotSampleMDS.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>ggplotSampleMDS</code> uses ggplot2
to provide plots of Metric MDS results.
By default, a pseudo Rsquare projection quality indicator,
and the number of dimensions of the MDS projection are provided in sub-title</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ggplotSampleMDS</span><span class="op">(</span></span>
<span>  <span class="va">mdsObj</span>,</span>
<span>  <span class="va">pData</span>,</span>
<span>  <span class="va">sampleSubset</span>,</span>
<span>  projectionAxes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  biplot <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  biplotType <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"correlation"</span>, <span class="st">"regression"</span><span class="op">)</span>,</span>
<span>  <span class="va">extVariables</span>,</span>
<span>  <span class="va">pDataForColour</span>,</span>
<span>  <span class="va">pDataForShape</span>,</span>
<span>  <span class="va">pDataForLabel</span>,</span>
<span>  <span class="va">pDataForAdditionalLabelling</span>,</span>
<span>  pointSize <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  pointSizeReflectingStress <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"Multi Dimensional Scaling"</span>,</span>
<span>  displayPointLabels <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  pointLabelSize <span class="op">=</span> <span class="fl">3.88</span>,</span>
<span>  repelPointLabels <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  displayArrowLabels <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  arrowLabelSize <span class="op">=</span> <span class="fl">3.88</span>,</span>
<span>  repelArrowLabels <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  arrowThreshold <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  flipXAxis <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  flipYAxis <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  displayPseudoRSq <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-mdsobj">mdsObj<a class="anchor" aria-label="anchor" href="#arg-mdsobj"></a></dt>
<dd><p>a MDS object, output of the <code><a href="computeMetricMDS.html">computeMetricMDS()</a></code> method.</p></dd>


<dt id="arg-pdata">pData<a class="anchor" aria-label="anchor" href="#arg-pdata"></a></dt>
<dd><p>(optional) a data.frame providing user input sample data.
These can be design of experiment variables, phenotype data per sample,...
and will be used to highlight sample categories in the plot
and/or for subsetting.</p></dd>


<dt id="arg-samplesubset">sampleSubset<a class="anchor" aria-label="anchor" href="#arg-samplesubset"></a></dt>
<dd><p>(optional) a logical vector, of size <code>nrow(pData)</code>,
which is by construction the nb of samples, indicating which samples to keep
in the plot. Typically it is obtained through the evaluation of
a logical condition on <code>pData</code> rows.</p></dd>


<dt id="arg-projectionaxes">projectionAxes<a class="anchor" aria-label="anchor" href="#arg-projectionaxes"></a></dt>
<dd><p>which two axes should be plotted
(should be a numeric vector of length 2)</p></dd>


<dt id="arg-biplot">biplot<a class="anchor" aria-label="anchor" href="#arg-biplot"></a></dt>
<dd><p>if TRUE, adds projection of external variables</p></dd>


<dt id="arg-biplottype">biplotType<a class="anchor" aria-label="anchor" href="#arg-biplottype"></a></dt>
<dd><p>type of biplot used:</p><ul><li><p>if "correlation", projection of external variables will be according to
Pearson correlations w.r.t. projection axes (arrow x &amp; y coordinates)</p></li>
<li><p>if "regression", a linear regression of external variables using the 2
projection axes as explanatory variables is performed, and the projection
of external variables will be according to regression coefficients
(arrow direction) and R square of regression (arrow size)</p></li>
</ul></dd>


<dt id="arg-extvariables">extVariables<a class="anchor" aria-label="anchor" href="#arg-extvariables"></a></dt>
<dd><p>are used to generate a biplot
these are the external variables that will be used in the biplot.
They should be provided as a matrix with named columns corresponding to the
variables. The number of rows should be the same as the number of samples.
The matrix might contain some NA's, in that case only complete rows will
be used to calculate biplot arrows.</p></dd>


<dt id="arg-pdataforcolour">pDataForColour<a class="anchor" aria-label="anchor" href="#arg-pdataforcolour"></a></dt>
<dd><p>(optional) which <code>pData</code> variable
will be used as colour aesthetic. Should be a character.</p></dd>


<dt id="arg-pdataforshape">pDataForShape<a class="anchor" aria-label="anchor" href="#arg-pdataforshape"></a></dt>
<dd><p>(optional) which <code>pData</code> variable
will be used as shape aesthetic. Should be a character.</p></dd>


<dt id="arg-pdataforlabel">pDataForLabel<a class="anchor" aria-label="anchor" href="#arg-pdataforlabel"></a></dt>
<dd><p>(optional) which <code>pData</code> variable
will be used as point labels in the plot. Should be a character.
If missing, point labels will be set equal to point names defined in
MDS object (if not NULL, otherwise no labels will be set).</p></dd>


<dt id="arg-pdataforadditionallabelling">pDataForAdditionalLabelling<a class="anchor" aria-label="anchor" href="#arg-pdataforadditionallabelling"></a></dt>
<dd><p>(optional) which <code>pData</code> variable(s)
will be added to the ggplot mapping, as to make them available for
<em>plotly</em> tooltipping. Should be an array of character.
Note this works only if biplot=FALSE, as biplots contain circle and arrows
that are currently not supported under <code>ggplotly</code>.</p></dd>


<dt id="arg-pointsize">pointSize<a class="anchor" aria-label="anchor" href="#arg-pointsize"></a></dt>
<dd><p>size of all points on the plots - only when
<code>pointSizeReflectingStress</code> is FALSE.</p></dd>


<dt id="arg-pointsizereflectingstress">pointSizeReflectingStress<a class="anchor" aria-label="anchor" href="#arg-pointsizereflectingstress"></a></dt>
<dd><p>if TRUE, size of points will appear
proportional to stress by point, i.e. the bigger the sample point appears,
the less accurate its representation is
(in terms of distances w.r.t. other points)</p></dd>


<dt id="arg-title">title<a class="anchor" aria-label="anchor" href="#arg-title"></a></dt>
<dd><p>title to give to the plot</p></dd>


<dt id="arg-displaypointlabels">displayPointLabels<a class="anchor" aria-label="anchor" href="#arg-displaypointlabels"></a></dt>
<dd><p>if TRUE, displays labels attached to points
(see <code>pDataForLabels</code> for the setting of the label values)</p></dd>


<dt id="arg-pointlabelsize">pointLabelSize<a class="anchor" aria-label="anchor" href="#arg-pointlabelsize"></a></dt>
<dd><p>size of point labels
(default: 3.88 as in <code>geom_text()</code>)</p></dd>


<dt id="arg-repelpointlabels">repelPointLabels<a class="anchor" aria-label="anchor" href="#arg-repelpointlabels"></a></dt>
<dd><p>if TRUE, uses <code><a href="https://ggrepel.slowkow.com/reference/geom_text_repel.html" class="external-link">ggrepel::geom_text_repel()</a></code>
instead of <code><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">ggplot2::geom_text()</a></code>
(try to split the labels such that they do not overlap) for the points</p></dd>


<dt id="arg-displayarrowlabels">displayArrowLabels<a class="anchor" aria-label="anchor" href="#arg-displayarrowlabels"></a></dt>
<dd><p>if TRUE, displays arrows labels (only with biplot)</p></dd>


<dt id="arg-arrowlabelsize">arrowLabelSize<a class="anchor" aria-label="anchor" href="#arg-arrowlabelsize"></a></dt>
<dd><p>size of arrow labels
(default: 3.88 as in <code>geom_text()</code>)</p></dd>


<dt id="arg-repelarrowlabels">repelArrowLabels<a class="anchor" aria-label="anchor" href="#arg-repelarrowlabels"></a></dt>
<dd><p>if TRUE, uses <code><a href="https://ggrepel.slowkow.com/reference/geom_text_repel.html" class="external-link">ggrepel::geom_text_repel()</a></code>
instead of <code><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">ggplot2::geom_text()</a></code> for the arrows (only with biplot)</p></dd>


<dt id="arg-arrowthreshold">arrowThreshold<a class="anchor" aria-label="anchor" href="#arg-arrowthreshold"></a></dt>
<dd><p>(only with biplot), arrows will be made barely visible
if their length is (in absolute value) less than this threshold.</p></dd>


<dt id="arg-flipxaxis">flipXAxis<a class="anchor" aria-label="anchor" href="#arg-flipxaxis"></a></dt>
<dd><p>if TRUE, take the opposite of x values
(provided as it might ease low dimensional projection comparisons)</p></dd>


<dt id="arg-flipyaxis">flipYAxis<a class="anchor" aria-label="anchor" href="#arg-flipyaxis"></a></dt>
<dd><p>if TRUE, take the opposite of y values
(provided as it might ease low dimensional projection comparisons)</p></dd>


<dt id="arg-displaypseudorsq">displayPseudoRSq<a class="anchor" aria-label="anchor" href="#arg-displaypseudorsq"></a></dt>
<dd><p>if TRUE, display pseudo RSquare in subtitle, on top
of nb of dimensions</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>additional parameters passed to <code><a href="https://ggrepel.slowkow.com/reference/geom_text_repel.html" class="external-link">ggrepel::geom_text_repel()</a></code>
(if used)</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>a ggplot object</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><a href="ggplotSampleMDSWrapBiplots.html">ggplotSampleMDSWrapBiplots</a>, <a href="ggplotSampleMDSShepard.html">ggplotSampleMDSShepard</a>,
<a href="computeMetricMDS.html">computeMetricMDS</a></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://uclouvain-cbio.github.io/CytoPipeline" class="external-link">CytoPipeline</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">OMIP021Samples</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># estimate scale transformations </span></span></span>
<span class="r-in"><span><span class="co"># and transform the whole OMIP021Samples</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">transList</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://uclouvain-cbio.github.io/CytoPipeline/reference/estimateScaleTransforms.html" class="external-link">estimateScaleTransforms</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    ff <span class="op">=</span> <span class="va">OMIP021Samples</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    fluoMethod <span class="op">=</span> <span class="st">"estimateLogicle"</span>,</span></span>
<span class="r-in"><span>    scatterMethod <span class="op">=</span> <span class="st">"linearQuantile"</span>,</span></span>
<span class="r-in"><span>    scatterRefMarker <span class="op">=</span> <span class="st">"BV785 - CD3"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">OMIP021Trans</span> <span class="op">&lt;-</span> <span class="fu">CytoPipeline</span><span class="fu">::</span><span class="fu"><a href="https://uclouvain-cbio.github.io/CytoPipeline/reference/applyScaleTransforms.html" class="external-link">applyScaleTransforms</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">OMIP021Samples</span>, </span></span>
<span class="r-in"><span>    <span class="va">transList</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># As there are only 2 samples in OMIP021Samples dataset,</span></span></span>
<span class="r-in"><span><span class="co"># we create artificial samples that are random combinations of both samples</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">ffList</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu">flowCore</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/flowCore/man/flowSet_to_list.html" class="external-link">flowSet_to_list</a></span><span class="op">(</span><span class="va">OMIP021Trans</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fl">3</span><span class="op">:</span><span class="fl">5</span>,</span></span>
<span class="r-in"><span>           FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>               <span class="fu"><a href="https://uclouvain-cbio.github.io/CytoPipeline/reference/aggregateAndSample.html" class="external-link">aggregateAndSample</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>                   <span class="va">OMIP021Trans</span>,</span></span>
<span class="r-in"><span>                   seed <span class="op">=</span> <span class="fl">10</span><span class="op">*</span><span class="va">i</span>,</span></span>
<span class="r-in"><span>                   nTotalEvents <span class="op">=</span> <span class="fl">5000</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">22</span><span class="op">]</span></span></span>
<span class="r-in"><span>           <span class="op">}</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">fsNames</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Donor1"</span>, <span class="st">"Donor2"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Agg"</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">ffList</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">fsNames</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">fsAll</span> <span class="op">&lt;-</span> <span class="fu">as</span><span class="op">(</span><span class="va">ffList</span>,<span class="st">"flowSet"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">flowCore</span><span class="fu">::</span><span class="fu">pData</span><span class="op">(</span><span class="va">fsAll</span><span class="op">)</span><span class="op">$</span><span class="va">type</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"real"</span>, <span class="st">"real"</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"synthetic"</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">flowCore</span><span class="fu">::</span><span class="fu">pData</span><span class="op">(</span><span class="va">fsAll</span><span class="op">)</span><span class="op">$</span><span class="va">grpId</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"D1"</span>, <span class="st">"D2"</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Agg"</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># calculate all pairwise distances</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">pwDist</span> <span class="op">&lt;-</span> <span class="fu"><a href="pairwiseEMDDist.html">pairwiseEMDDist</a></span><span class="op">(</span><span class="va">fsAll</span>, </span></span>
<span class="r-in"><span>                             channels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"FSC-A"</span>, <span class="st">"SSC-A"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                             verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># compute Metric MDS object with explicit number of dimensions</span></span></span>
<span class="r-in"><span><span class="va">mdsObj</span> <span class="op">&lt;-</span> <span class="fu"><a href="computeMetricMDS.html">computeMetricMDS</a></span><span class="op">(</span><span class="va">pwDist</span>, nDim <span class="op">=</span> <span class="fl">4</span>, seed <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">dim</span> <span class="op">&lt;-</span> <span class="fu"><a href="MDS.html">nDim</a></span><span class="op">(</span><span class="va">mdsObj</span><span class="op">)</span> <span class="co"># should be 4</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#' # compute Metric MDS object by reaching a target pseudo RSquare</span></span></span>
<span class="r-in"><span><span class="va">mdsObj2</span> <span class="op">&lt;-</span> <span class="fu"><a href="computeMetricMDS.html">computeMetricMDS</a></span><span class="op">(</span><span class="va">pwDist</span>, seed <span class="op">=</span> <span class="fl">0</span>, targetPseudoRSq <span class="op">=</span> <span class="fl">0.999</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plot mds projection on axes 1 and 2,</span></span></span>
<span class="r-in"><span><span class="co"># use 'grpId' for colour, 'type' for shape, and no label </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">p_12</span> <span class="op">&lt;-</span> <span class="fu">ggplotSampleMDS</span><span class="op">(</span></span></span>
<span class="r-in"><span>    mdsObj <span class="op">=</span> <span class="va">mdsObj</span>,</span></span>
<span class="r-in"><span>    pData <span class="op">=</span> <span class="fu">flowCore</span><span class="fu">::</span><span class="fu">pData</span><span class="op">(</span><span class="va">fsAll</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    projectionAxes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    pDataForColour <span class="op">=</span> <span class="st">"grpId"</span>,</span></span>
<span class="r-in"><span>    pDataForShape <span class="op">=</span> <span class="st">"type"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plot mds projection on axes 3 and 4,</span></span></span>
<span class="r-in"><span><span class="co"># use 'grpId' for colour, and 'name' as point label</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">p_34</span> <span class="op">&lt;-</span> <span class="fu">ggplotSampleMDS</span><span class="op">(</span></span></span>
<span class="r-in"><span>    mdsObj <span class="op">=</span> <span class="va">mdsObj</span>,</span></span>
<span class="r-in"><span>    pData <span class="op">=</span> <span class="fu">flowCore</span><span class="fu">::</span><span class="fu">pData</span><span class="op">(</span><span class="va">fsAll</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    projectionAxes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    pDataForColour <span class="op">=</span> <span class="st">"grpId"</span>,</span></span>
<span class="r-in"><span>    pDataForLabel <span class="op">=</span> <span class="st">"name"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plot mds projection on axes 1 and 2,</span></span></span>
<span class="r-in"><span><span class="co"># use 'group' for colour, 'type' for shape, and 'name' as point label</span></span></span>
<span class="r-in"><span><span class="co"># have sample point size reflecting 'stress'</span></span></span>
<span class="r-in"><span><span class="co"># i.e. quality of projection w.r.t. distances to other points</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">p12_Stress</span> <span class="op">&lt;-</span> <span class="fu">ggplotSampleMDS</span><span class="op">(</span></span></span>
<span class="r-in"><span>    mdsObj <span class="op">=</span> <span class="va">mdsObj</span>,</span></span>
<span class="r-in"><span>    pData <span class="op">=</span> <span class="fu">flowCore</span><span class="fu">::</span><span class="fu">pData</span><span class="op">(</span><span class="va">fsAll</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    projectionAxes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    pDataForColour <span class="op">=</span> <span class="st">"grpId"</span>,</span></span>
<span class="r-in"><span>    pDataForLabel <span class="op">=</span> <span class="st">"name"</span>,</span></span>
<span class="r-in"><span>    pDataForShape <span class="op">=</span> <span class="st">"type"</span>,</span></span>
<span class="r-in"><span>    pointSizeReflectingStress <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># try to associate axes with median of each channel</span></span></span>
<span class="r-in"><span><span class="co"># =&gt; use bi-plot</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">extVars</span> <span class="op">&lt;-</span> <span class="fu"><a href="channelSummaryStats.html">channelSummaryStats</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">fsAll</span>,</span></span>
<span class="r-in"><span>    channels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"FSC-A"</span>, <span class="st">"SSC-A"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    statFUNs <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">bp_12</span> <span class="op">&lt;-</span> <span class="fu">ggplotSampleMDS</span><span class="op">(</span></span></span>
<span class="r-in"><span>    mdsObj <span class="op">=</span> <span class="va">mdsObj</span>,</span></span>
<span class="r-in"><span>    pData <span class="op">=</span> <span class="fu">flowCore</span><span class="fu">::</span><span class="fu">pData</span><span class="op">(</span><span class="va">fsAll</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    projectionAxes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    biplot <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    extVariables <span class="op">=</span> <span class="va">extVars</span>,</span></span>
<span class="r-in"><span>    pDataForColour <span class="op">=</span> <span class="st">"grpId"</span>,</span></span>
<span class="r-in"><span>    pDataForShape <span class="op">=</span> <span class="st">"type"</span>,</span></span>
<span class="r-in"><span>    seed <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">bp_34</span> <span class="op">&lt;-</span> <span class="fu">ggplotSampleMDS</span><span class="op">(</span></span></span>
<span class="r-in"><span>    mdsObj <span class="op">=</span> <span class="va">mdsObj</span>,</span></span>
<span class="r-in"><span>    pData <span class="op">=</span> <span class="fu">flowCore</span><span class="fu">::</span><span class="fu">pData</span><span class="op">(</span><span class="va">fsAll</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    projectionAxes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    biplot <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    extVariables <span class="op">=</span> <span class="va">extVars</span>,</span></span>
<span class="r-in"><span>    pDataForColour <span class="op">=</span> <span class="st">"grpId"</span>,</span></span>
<span class="r-in"><span>    pDataForLabel <span class="op">=</span> <span class="st">"name"</span>,</span></span>
<span class="r-in"><span>    seed <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Philippe Hauchamps, Laurent Gatto.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000.</p>
</div>

    </footer></div>





  </body></html>

