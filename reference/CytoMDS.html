<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>CytoMDS package — CytoMDS • CytoMDS</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="CytoMDS package — CytoMDS"><meta property="og:description" content="CytoMDS implements a low dimensional visualization of a set of cytometry
samples, in order to visually assess the 'distances' between them.
This, in turn, can greatly help the user to identify quality issues
like batch effects or outlier samples, and/or check the presence of
potential sample clusters that might align with the experimental design.
The CytoMDS algorithm combines, on the one hand,
the concept of Earth Mover's Distance (EMD), a.k.a. Wasserstein metric
and, on the other hand, the Multi Dimensional Scaling (MDS) algorithm
for the low dimensional projection.
Also, the package provides some diagnostic tools for
both checking the quality of the MDS projection,
as well as tools to help with the interpretation of
the axes of the projection.
ggplotSamplesMDS uses ggplot2
to provide plots of Metric MDS results.
If both projectionAxes are in c(1,2),
a global RSquare for these 2 axes is provided. For additional dimensions,
a marginal RSquare per dimension is provided.
ggplotSamplesMDSShepard uses ggplot2
to provide plot of Metric MDS results.
Shepard diagram provides a scatter plot of :
on the x axis, the high dimensional pairwise distances
between each sample pairs
on the y axis, the corresponding pairwise distances in the obtained
low dimensional projection

"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">CytoMDS</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.99.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/CytoMDS.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/UCLouvain-CBIO/CytoMDS/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>CytoMDS package</h1>
    <small class="dont-index">Source: <a href="https://github.com/UCLouvain-CBIO/CytoMDS/blob/HEAD/R/CytoMDS.R" class="external-link"><code>R/CytoMDS.R</code></a>, <a href="https://github.com/UCLouvain-CBIO/CytoMDS/blob/HEAD/R/ggplots.R" class="external-link"><code>R/ggplots.R</code></a></small>
    <div class="hidden name"><code>CytoMDS.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>CytoMDS</code> implements a low dimensional visualization of a set of cytometry
samples, in order to visually assess the 'distances' between them.
This, in turn, can greatly help the user to identify quality issues
like batch effects or outlier samples, and/or check the presence of
potential sample clusters that might align with the experimental design.</p>
<p>The CytoMDS algorithm combines, on the one hand,
the concept of Earth Mover's Distance (EMD), a.k.a. Wasserstein metric
and, on the other hand, the Multi Dimensional Scaling (MDS) algorithm
for the low dimensional projection.</p>
<p>Also, the package provides some diagnostic tools for
both checking the quality of the MDS projection,
as well as tools to help with the interpretation of
the axes of the projection.</p>
<p><code>ggplotSamplesMDS</code> uses ggplot2
to provide plots of Metric MDS results.
If both <code>projectionAxes</code> are in c(1,2),
a global RSquare for these 2 axes is provided. For additional dimensions,
a marginal RSquare per dimension is provided.</p>
<p><code>ggplotSamplesMDSShepard</code> uses ggplot2
to provide plot of Metric MDS results.
Shepard diagram provides a scatter plot of :</p><ul><li><p>on the x axis, the high dimensional pairwise distances
between each sample pairs</p></li>
<li><p>on the y axis, the corresponding pairwise distances in the obtained
low dimensional projection</p></li>
</ul></div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ggplotSamplesMDS</span><span class="op">(</span></span>
<span>  <span class="va">mdsObj</span>,</span>
<span>  pData <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>sampleId <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mdsObj</span><span class="op">$</span><span class="va">proj</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  projectionAxes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  biplot <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  extVariables <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pDataForColour <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pDataForShape <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pDataForLabel <span class="op">=</span> <span class="st">"name"</span>,</span>
<span>  pDataForAdditionalLabelling <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sizeReflectingStress <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"Multi Dimensional Scaling"</span>,</span>
<span>  repelPointsLabels <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  repelArrowsLabels <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplotSamplesMDSShepard</span><span class="op">(</span></span>
<span>  <span class="va">mdsObj</span>,</span>
<span>  nDim <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"Multi Dimensional Scaling - Shepard's diagram"</span>,</span>
<span>  pointSize <span class="op">=</span> <span class="fl">0.5</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>mdsObj</dt>
<dd><p>a MDS object calculated by the SMACOF algorithm using
the computeMetricMDS() function</p></dd>


<dt>pData</dt>
<dd><p>a data.frame providing user input sample data.
These can be design of experiment variables, phenotype data per sample,...
and will be used to highlight sample categories in the plot.</p></dd>


<dt>projectionAxes</dt>
<dd><p>which two axes should be plotted
(should be a numeric vector of length 2)</p></dd>


<dt>biplot</dt>
<dd><p>if TRUE, adds projection of external variables</p></dd>


<dt>extVariables</dt>
<dd><p>are used to generate a biplot
these are the external variables to regress with obtained configuration
according to the two projection axes</p></dd>


<dt>pDataForColour</dt>
<dd><p>if not NULL, which <code>pData</code> variable
will be used as colour aesthetic. Should be a character.</p></dd>


<dt>pDataForShape</dt>
<dd><p>if not NULL, which <code>pData</code> variable
will be used as shape aesthetic. Should be a character.</p></dd>


<dt>pDataForLabel</dt>
<dd><p>if not NULL, which <code>pData</code> variable
will be used as point labels in the plot. Should be a character.</p></dd>


<dt>pDataForAdditionalLabelling</dt>
<dd><p>if not NULL, which <code>pData</code> variable(s)
will be add to the ggplot mapping, as to make them available for
<em>plotly</em> tooltipping. Should be an array of character of maximum length 3.
Note this works only if biplot=FALSE, as biplots contain circle and arrows
that are currently not supported under <code>ggplotly</code>.</p></dd>


<dt>sizeReflectingStress</dt>
<dd><p>if TRUE, size of points will appear
proportional to stress by point, i.e. the bigger the sample point appears,
the less accurate its representation is
(in terms of distances w.r.t. other points)</p></dd>


<dt>title</dt>
<dd><p>title to give to the plot</p></dd>


<dt>repelPointsLabels</dt>
<dd><p>if TRUE, uses <code><a href="https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html" class="external-link">ggrepel::geom_text_repel()</a></code>
instead of <code><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">ggplot2::geom_text()</a></code>
(try to split the labels such that they do not overlap) for the points</p></dd>


<dt>repelArrowsLabels</dt>
<dd><p>if TRUE, uses <code><a href="https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html" class="external-link">ggrepel::geom_text_repel()</a></code>
instead of <code><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">ggplot2::geom_text()</a></code> for the arrows</p></dd>


<dt>...</dt>
<dd><p>additional parameters passed to <code><a href="https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html" class="external-link">ggrepel::geom_text_repel()</a></code>
(if used)</p></dd>


<dt>nDim</dt>
<dd><p>number of dimensions to use when calculating
Shepard's diagram and Rsquare.
If <code>NULL</code>, it will be set equal to the number of projection dimensions
as calculated in <code>mdsObj</code></p></dd>


<dt>pointSize</dt>
<dd><p>plot size of points</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>a ggplot object</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>ggplotSamplesMDS, ggplotSamplesMDSShepard, <a href="computeMetricMDS.html">computeMetricMDS</a></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://uclouvain-cbio.github.io/CytoPipeline" class="external-link">CytoPipeline</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">OMIP021Samples</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># estimate scale transformations </span></span></span>
<span class="r-in"><span><span class="co"># and transform the whole OMIP021Samples</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">transList</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://uclouvain-cbio.github.io/CytoPipeline/reference/estimateScaleTransforms.html" class="external-link">estimateScaleTransforms</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    ff <span class="op">=</span> <span class="va">OMIP021Samples</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    fluoMethod <span class="op">=</span> <span class="st">"estimateLogicle"</span>,</span></span>
<span class="r-in"><span>    scatterMethod <span class="op">=</span> <span class="st">"linearQuantile"</span>,</span></span>
<span class="r-in"><span>    scatterRefMarker <span class="op">=</span> <span class="st">"BV785 - CD3"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> estimating logicle transformations for fluorochrome channels...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimating linear transformation for scatter channels : reference marker = BV785 - CD3...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> applying specific linear transformation for FSC-A channel...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> initial quantiles : q5 = 10464.0482 ; q95 = 192509.607</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> target quantiles : q5 = 0.3849 ; q95 = 2.9395</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> a = 1.40e-05 ; b = 2.38e-01</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> applying FSC-A linear transformation for FSC-H channel...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> applying specific linear transformation for SSC-A channel...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> initial quantiles : q5 = 16345.6462 ; q95 = 245485.3555</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> target quantiles : q5 = 0.3849 ; q95 = 2.9395</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> a = 1.11e-05 ; b = 2.03e-01</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> applying SSC-A linear transformation for SSC-H channel...</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">OMIP021Trans</span> <span class="op">&lt;-</span> <span class="fu">CytoPipeline</span><span class="fu">::</span><span class="fu"><a href="https://uclouvain-cbio.github.io/CytoPipeline/reference/applyScaleTransforms.html" class="external-link">applyScaleTransforms</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">OMIP021Samples</span>, </span></span>
<span class="r-in"><span>    <span class="va">transList</span><span class="op">)</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span><span class="va">ffList</span> <span class="op">&lt;-</span> <span class="fu">flowCore</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/flowCore/man/flowSet_to_list.html" class="external-link">flowSet_to_list</a></span><span class="op">(</span><span class="va">OMIP021Trans</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># As there are only 2 samples in OMIP021Samples dataset,</span></span></span>
<span class="r-in"><span><span class="co"># we create artificial samples that are random combinations of both samples</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">3</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">ffList</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> </span></span>
<span class="r-in"><span>        <span class="fu">CytoPipeline</span><span class="fu">::</span><span class="fu"><a href="https://uclouvain-cbio.github.io/CytoPipeline/reference/aggregateAndSample.html" class="external-link">aggregateAndSample</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>            <span class="va">OMIP021Trans</span>,</span></span>
<span class="r-in"><span>            seed <span class="op">=</span> <span class="fl">10</span><span class="op">*</span><span class="va">i</span>,</span></span>
<span class="r-in"><span>            nTotalEvents <span class="op">=</span> <span class="fl">5000</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">22</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">fsNames</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Donor1"</span>, <span class="st">"Donor2"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Agg"</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">ffList</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">fsNames</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">fsAll</span> <span class="op">&lt;-</span> <span class="fu">as</span><span class="op">(</span><span class="va">ffList</span>,<span class="st">"flowSet"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># calculate all pairwise distances</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">pwDist</span> <span class="op">&lt;-</span> <span class="fu"><a href="getPairWiseEMDDist.html">getPairwiseEMDDist</a></span><span class="op">(</span><span class="va">fsAll</span>, </span></span>
<span class="r-in"><span>                             channels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"FSC-A"</span>, <span class="st">"SSC-A"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                             verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># compute Metric MDS object</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mdsObj</span> <span class="op">&lt;-</span> <span class="fu"><a href="computeMetricMDS.html">computeMetricMDS</a></span><span class="op">(</span><span class="va">pwDist</span>, nDim <span class="op">=</span> <span class="fl">4</span>, seed <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>RGL: unable to open X11 display</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>'rgl.init' failed, running with 'rgl.useNULL = TRUE'.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plot mds projection on axes 1 and 2,</span></span></span>
<span class="r-in"><span><span class="co"># use 'group' for colour, 'type' for shape, and no label </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">p_12</span> <span class="op">&lt;-</span> <span class="fu">ggplotSamplesMDS</span><span class="op">(</span></span></span>
<span class="r-in"><span>    mdsObj <span class="op">=</span> <span class="va">mdsObj</span>,</span></span>
<span class="r-in"><span>    pData <span class="op">=</span> <span class="fu">flowCore</span><span class="fu">::</span><span class="fu">pData</span><span class="op">(</span><span class="va">fsAll</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    projectionAxes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    pDataForColour <span class="op">=</span> <span class="st">"group"</span>,</span></span>
<span class="r-in"><span>    pDataForLabel <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>    pDataForShape <span class="op">=</span> <span class="st">"type"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plot mds projection on axes 3 and 4,</span></span></span>
<span class="r-in"><span><span class="co"># use 'group' for colour, and 'name' as point label</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">p_34</span> <span class="op">&lt;-</span> <span class="fu">ggplotSamplesMDS</span><span class="op">(</span></span></span>
<span class="r-in"><span>    mdsObj <span class="op">=</span> <span class="va">mdsObj</span>,</span></span>
<span class="r-in"><span>    pData <span class="op">=</span> <span class="fu">flowCore</span><span class="fu">::</span><span class="fu">pData</span><span class="op">(</span><span class="va">fsAll</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    projectionAxes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    pDataForColour <span class="op">=</span> <span class="st">"group"</span>,</span></span>
<span class="r-in"><span>    pDataForLabel <span class="op">=</span> <span class="st">"name"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plot mds projection on axes 1 and 2,</span></span></span>
<span class="r-in"><span><span class="co"># use 'group' for colour, 'type' for shape, and 'name' as point label</span></span></span>
<span class="r-in"><span><span class="co"># have sample point size reflecting 'stress'</span></span></span>
<span class="r-in"><span><span class="co"># i.e. quality of projection w.r.t. distances to other points</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">p12_Stress</span> <span class="op">&lt;-</span> <span class="fu">ggplotSamplesMDS</span><span class="op">(</span></span></span>
<span class="r-in"><span>    mdsObj <span class="op">=</span> <span class="va">mdsObj</span>,</span></span>
<span class="r-in"><span>    pData <span class="op">=</span> <span class="fu">flowCore</span><span class="fu">::</span><span class="fu">pData</span><span class="op">(</span><span class="va">fsAll</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    projectionAxes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    pDataForColour <span class="op">=</span> <span class="st">"group"</span>,</span></span>
<span class="r-in"><span>    pDataForLabel <span class="op">=</span> <span class="st">"name"</span>,</span></span>
<span class="r-in"><span>    pDataForShape <span class="op">=</span> <span class="st">"type"</span>,</span></span>
<span class="r-in"><span>    sizeReflectingStress <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># try to associate axes with median of each channel</span></span></span>
<span class="r-in"><span><span class="co"># =&gt; use bi-plot</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">extVars</span> <span class="op">&lt;-</span> <span class="fu"><a href="getChannelsSummaryStat.html">getChannelsSummaryStat</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">fsAll</span>,</span></span>
<span class="r-in"><span>    channels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"FSC-A"</span>, <span class="st">"SSC-A"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    statsFUN <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">bp_12</span> <span class="op">&lt;-</span> <span class="fu">ggplotSamplesMDS</span><span class="op">(</span></span></span>
<span class="r-in"><span>    mdsObj <span class="op">=</span> <span class="va">mdsObj</span>,</span></span>
<span class="r-in"><span>    pData <span class="op">=</span> <span class="fu">flowCore</span><span class="fu">::</span><span class="fu">pData</span><span class="op">(</span><span class="va">fsAll</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    projectionAxes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    biplot <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    extVariables <span class="op">=</span> <span class="va">extVars</span>,</span></span>
<span class="r-in"><span>    pDataForColour <span class="op">=</span> <span class="st">"group"</span>,</span></span>
<span class="r-in"><span>    pDataForLabel <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>    pDataForShape <span class="op">=</span> <span class="st">"type"</span>,</span></span>
<span class="r-in"><span>    seed <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">bp_34</span> <span class="op">&lt;-</span> <span class="fu">ggplotSamplesMDS</span><span class="op">(</span></span></span>
<span class="r-in"><span>    mdsObj <span class="op">=</span> <span class="va">mdsObj</span>,</span></span>
<span class="r-in"><span>    pData <span class="op">=</span> <span class="fu">flowCore</span><span class="fu">::</span><span class="fu">pData</span><span class="op">(</span><span class="va">fsAll</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    projectionAxes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    biplot <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    extVariables <span class="op">=</span> <span class="va">extVars</span>,</span></span>
<span class="r-in"><span>    pDataForColour <span class="op">=</span> <span class="st">"group"</span>,</span></span>
<span class="r-in"><span>    pDataForLabel <span class="op">=</span> <span class="st">"name"</span>,</span></span>
<span class="r-in"><span>    seed <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Shepard diagrams </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">p2D</span> <span class="op">&lt;-</span> <span class="fu">ggplotSamplesMDSShepard</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">mdsObj</span>,</span></span>
<span class="r-in"><span>    nDim <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>    pointSize <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    title <span class="op">=</span> <span class="st">"Shepard with 2 dimensions"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">p3D</span> <span class="op">&lt;-</span> <span class="fu">ggplotSamplesMDSShepard</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">mdsObj</span>,</span></span>
<span class="r-in"><span>    nDim <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>    title <span class="op">=</span> <span class="st">"Shepard with 3 dimensions"</span><span class="op">)</span> </span></span>
<span class="r-in"><span>    <span class="co">#' </span></span></span>
<span class="r-in"><span><span class="va">pDefD</span> <span class="op">&lt;-</span> <span class="fu">ggplotSamplesMDSShepard</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">mdsObj</span>,</span></span>
<span class="r-in"><span>    title <span class="op">=</span> <span class="st">"Shepard with default nb of dimensions"</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Philippe Hauchamps, Laurent Gatto.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.9000.</p>
</div>

      </footer></div>

  


  

  </body></html>

